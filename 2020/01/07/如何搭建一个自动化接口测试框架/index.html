<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>如何搭建一个自动化接口测试框架 | LetonLIU的博客</title><meta name="description" content="如何搭建一个自动化接口测试框架"><meta name="keywords" content><meta name="author" content="WenJingliu"><meta name="copyright" content="WenJingliu"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="canonical" href="http://yoursite.com/2020/01/07/如何搭建一个自动化接口测试框架/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="如何搭建一个自动化接口测试框架"><meta name="twitter:description" content="如何搭建一个自动化接口测试框架"><meta name="twitter:image" content="https://lemonliu.oss-cn-beijing.aliyuncs.com/a6b393ec5be60b6d07f20395034c77b.jpg"><meta property="og:type" content="article"><meta property="og:title" content="如何搭建一个自动化接口测试框架"><meta property="og:url" content="http://yoursite.com/2020/01/07/如何搭建一个自动化接口测试框架/"><meta property="og:site_name" content="LetonLIU的博客"><meta property="og:description" content="如何搭建一个自动化接口测试框架"><meta property="og:image" content="https://lemonliu.oss-cn-beijing.aliyuncs.com/a6b393ec5be60b6d07f20395034c77b.jpg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="prev" title="如何有效学习数据结构与算法" href="http://yoursite.com/2020/01/07/如何有效学习数据结构与算法/"><link rel="next" title href="http://yoursite.com/2020/01/06/IDEA快捷键/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  highlight_copy: 'false',
  highlight_lang: 'true',
  highlight_shrink: 'true',
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: '添加书签',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  copyright: undefined,
  copy_copyright_js: false
  
}</script></head><body><canvas class="fireworks"></canvas><div id="header"> <div id="page-header"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">LetonLIU的博客</a></span><i class="fa fa-bars fa-fw toggle-menu pull-right close" aria-hidden="true"></i><span class="pull-right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw fa fa-photo"></i><span> Gallery</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div><script>document.body.addEventListener('touchstart', function(){ });</script></div></span><span class="pull-right" id="search_button"></span></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="lozad avatar_img" src="https://lemonliu.oss-cn-beijing.aliyuncs.com/K9b8cReo3z9m.jpg" onerror="onerror=null;src='/img/friend_404.gif'"></div><div class="mobile_post_data"><div class="mobile_data_item is_center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">35</div></a></div></div><div class="mobile_data_item is_center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">5</div></a></div></div><div class="mobile_data_item is_center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">3</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw fa fa-photo"></i><span> Gallery</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div><script>document.body.addEventListener('touchstart', function(){ });</script></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#项目整体框架结构"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">项目整体框架结构</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#框架代码详解"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text">框架代码详解</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#代码部分"><span class="toc_mobile_items-number">3.</span> <span class="toc_mobile_items-text">代码部分</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#测试用例"><span class="toc_mobile_items-number">4.</span> <span class="toc_mobile_items-text">测试用例</span></a></li></ol></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#项目整体框架结构"><span class="toc-number">1.</span> <span class="toc-text">项目整体框架结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#框架代码详解"><span class="toc-number">2.</span> <span class="toc-text">框架代码详解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#代码部分"><span class="toc-number">3.</span> <span class="toc-text">代码部分</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#测试用例"><span class="toc-number">4.</span> <span class="toc-text">测试用例</span></a></li></ol></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://lemonliu.oss-cn-beijing.aliyuncs.com/a6b393ec5be60b6d07f20395034c77b.jpg)"><div id="post-info"><div id="post-title"><div class="posttitle">如何搭建一个自动化接口测试框架</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2020-01-07<span class="post-meta__separator">|</span><i class="fa fa-history" aria-hidden="true"></i> 更新于 2020-01-08</time><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">5k</span><span class="post-meta__separator">|</span><span>阅读时长: 22 分钟</span><span class="post-meta__separator">|</span><span>阅读量: </span><span id="busuanzi_value_page_pv"></span></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><p><a href="https://gitee.com/cancerGit/Crown" target="_blank" rel="noopener">Crown</a>是一个Mybatis-plus的展示项目，他有完备的安全性测试以及致力于使用最简单的代码实现最好的功能，这里是记录此项目的用户管理模块的接口测试，项目采用REST Assured框架，基于Groovy语言共同构建测试框架，request的管理通过velocity将数据对象与模板文件进行merge，采用build模式来构建对象，最终实现接口测试的自动化</p>
<p><a href="https://github.com/wawawawawawawawawawa/apitest" target="_blank" rel="noopener">测试代码</a></p>
<h4 id="项目整体框架结构"><a href="#项目整体框架结构" class="headerlink" title="项目整体框架结构"></a>项目整体框架结构</h4><ul>
<li><p>项目文件部分<img alt="项目文件" data-src="https://lemonliu.oss-cn-beijing.aliyuncs.com/项目结构.png" class="lozad"></p>
</li>
<li><p>资源文件部分</p>
<p>  <img alt="resources文件" data-src="https://lemonliu.oss-cn-beijing.aliyuncs.com/resources文件.png" class="lozad"></p>
<p>  ​</p>
</li>
</ul>
<h4 id="框架代码详解"><a href="#框架代码详解" class="headerlink" title="框架代码详解"></a>框架代码详解</h4><p>整体的代码使用到的相应框架以及知识点我都会尽可能详细的记录下来，代码的顺序也是按照常规构建项目框架的顺序来进行布局，遇到问题或者bug可以联系我，不尽感激</p>
<p>我们先规划一下给一个实际项目搭建接口测试的思路，由简到难，流程如下：</p>
<ul>
<li>第一步：先用REST Assured调通被测接口，此时接口的 BaseUri、用户名、密码等信息都是写死的，接口校验部分只校验状态码。</li>
<li>第二步：结合业务看看接口 Request Body 中需要校验哪些内容，利用 JsonSlurper 或者 XmlSlurper获取 Body 中的值进行校验。</li>
<li>第三步：看看是否需要校验接口的response schema，如果需要，先定义好schema，然后实现校验的逻辑。</li>
<li>第四步：对于post请求的接口，用 Velocity 来管理接口的 Request Body ，方便后续进行参数化。</li>
<li>第五步：把环境相关的信息进行统一管理，修改接口调用的代码，实现从 yaml 文件中读取配置信息。</li>
<li>第六步：结合业务场景分析哪些数据需要在全局初始化，实现一键运行即可初始化所有的测试数据。（备注：单个用例的数据初始化放到 Case 中实现）</li>
<li>第七步：对测试数据和配置信息中的敏感信息进行脱敏处理。</li>
<li>第八步：结合业务场景把case划分到不同的 TestSuite ，例如可以按照功能模块划分 TestSuite 。</li>
<li>第九步：把自动化脚本配置到 Jenkins 上运行，如果公司有定制化的 CI/CD 平台，可以配置到 CI/CD 平台上，每天通过平台获取测试报告分析接口测试运行情况。</li>
</ul>
<h4 id="代码部分"><a href="#代码部分" class="headerlink" title="代码部分"></a>代码部分</h4><ul>
<li><p>LoginClient</p>
  <figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.winicssec.crown.util.login</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.winicssec.crown.testdata.service.GlobalUserService</span><br><span class="line"><span class="keyword">import</span> com.winicssec.crown.util.ConfigParse</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> io.restassured.RestAssured.given</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 首先使用REST Assured调通被测接口</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LoginClient</span> &#123;</span></span><br><span class="line">    GlobalUserService globalUserService   <span class="comment">//从各种格式的配置文件中读取数据用于初始化</span></span><br><span class="line">    ConfigParse configParse         <span class="comment">//这里调用Configparse，因为所有环境相关的配置信息都放到了yaml文件中</span></span><br><span class="line"></span><br><span class="line">    LoginClient() &#123;</span><br><span class="line">        globalUserService = <span class="keyword">new</span> GlobalUserService()</span><br><span class="line">        configParse = <span class="keyword">new</span> ConfigParse()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> clientWithSpecialRole(roleName) &#123;</span><br><span class="line">        <span class="keyword">def</span> userInfo = globalUserService.getUserInfoByRole(roleName) <span class="comment">//根据角色获取用户信息</span></span><br><span class="line">        setDefaultUriAndContentType()  <span class="comment">//该方法和getTokenByUser方法都需要设置baseUri，header等，所以把公共的内容抽取了一个“setDefaultUriAndContentType”方法，减少冗余</span></span><br><span class="line">                .header(<span class="string">"Authorization"</span>, getTokenByUser(userInfo.userName, userInfo.password)) <span class="comment">//查看web应用可以看到所有接口调用都需要在header中设置token</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">def</span> getTokenByUser(userName, password) &#123;</span><br><span class="line">        HashMap userMap = <span class="keyword">new</span> HashMap()  <span class="comment">//这里是根据用户名称和密码生成token的方法</span></span><br><span class="line">        userMap.put(<span class="string">"loginName"</span>, userName)</span><br><span class="line">        userMap.put(<span class="string">"password"</span>, password)</span><br><span class="line">        <span class="keyword">def</span> token = setDefaultUriAndContentType()</span><br><span class="line">                .body(userMap)</span><br><span class="line">                .post(<span class="string">"/account/token"</span>)</span><br><span class="line">                .then().assertThat().statusCode(<span class="number">200</span>)</span><br><span class="line">                .extract().response().path(<span class="string">"result.token"</span>)</span><br><span class="line">        token = <span class="string">"Bearer "</span> + token</span><br><span class="line">        token</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">def</span> setDefaultUriAndContentType(contentType = <span class="string">"application/json"</span>) &#123;</span><br><span class="line">        given().baseUri((String) configParse.getGlobalConfig().baseUrl)</span><br><span class="line">                .header(<span class="string">"Content-Type"</span>, contentType)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>  此部分用到了初始化数据类GlobalUserService以及配置文件类ConfigParse</p>
</li>
<li><p>GlobaUserService</p>
  <figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.github.crown.testdata.service</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.github.crown.scenario.userManage.repository.UserRepository</span><br><span class="line"><span class="keyword">import</span> com.github.crown.scenario.userManage.service.UserService</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GlobalUserService</span> &#123;</span></span><br><span class="line">    UserRepository userRepository</span><br><span class="line">    UserService userService</span><br><span class="line">    com.github.crown.util.CrownFileService crownFileService      </span><br><span class="line"></span><br><span class="line">    GlobalUserService() &#123;</span><br><span class="line">        userRepository = <span class="keyword">new</span> UserRepository()</span><br><span class="line">        userService = <span class="keyword">new</span> UserService()</span><br><span class="line">        crownFileService = <span class="keyword">new</span> com.github.crown.util.CrownFileService()     <span class="comment">//处理各类文件Class</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">def</span> getAllUserInfo() &#123;</span><br><span class="line">        crownFileService.getCsvFileContent(<span class="string">"src/test/resources/com/github/crown/data/user.csv"</span>, <span class="string">","</span>)   <span class="comment">//从文件中获取用户信息</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">def</span> getAllRoleMenuInfo() &#123;</span><br><span class="line">        crownFileService.getCsvFileContent(<span class="string">"src/test/resources/com/github/crown/data/role.csv"</span>, <span class="string">";"</span>)   <span class="comment">//从文件中获取角色信息，当你熟悉这个被测web后，你会发现角色需要有权限，还需要关联对应的menuId即菜单Id，所以此表存放了角色名称与menuId的关系</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> getUserInfoByRole(roleName) &#123;</span><br><span class="line">        getAllUserInfo().find &#123; it -&gt; it.roleName == roleName &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> addGlobalUsers() &#123;</span><br><span class="line">        <span class="keyword">def</span> allUserInfo = getAllUserInfo()</span><br><span class="line">        allUserInfo.each &#123;</span><br><span class="line">            userService.addUser(it.userName, it.password, it.roleName)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> initGlobalRole() &#123;</span><br><span class="line">        <span class="keyword">def</span> allRoleMenuInfo = getAllRoleMenuInfo()</span><br><span class="line">        allRoleMenuInfo.each &#123;</span><br><span class="line">            <span class="keyword">if</span> (!ifRoleExist(it.roleName)) &#123;     <span class="comment">//这里是初始化角色，需要先把角色初始化好后，才能创建用户，然后把对于的角色与用户关联，需要注意这里做了判断，如果角色已经存在则不再重复创建，这个是接口测试处理数据中需要注意的问题。</span></span><br><span class="line">                userRepository.insertSysRoleTable(it.roleName)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> ifRoleExist(roleName) &#123;</span><br><span class="line">        userRepository.getRoleInfoByRoleName(roleName) ? true : <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> initRoleMenuId() &#123;          <span class="comment">//角色创建后，还需要把角色与对应的菜单Id关联，那么这个角色才真正具备对应的权限，这里的作用是把角色和对于的menuId进行关联</span></span><br><span class="line">        <span class="keyword">def</span> allRoleMenuInfo = getAllRoleMenuInfo()</span><br><span class="line">        <span class="keyword">def</span> roleId</span><br><span class="line">        allRoleMenuInfo.each &#123;</span><br><span class="line">            roleId = userRepository.getRoleInfoByRoleName(it.roleName).id</span><br><span class="line">            parseMenuIdList(it.menuIdList).each &#123; menuId -&gt;</span><br><span class="line">                menuId</span><br><span class="line">                <span class="keyword">if</span> (!ifRoleIdMenuIdExist(roleId, menuId)) &#123; <span class="comment">//这里先判断roleId与menuId是否存在，如果存在则不再添加，保证数据不重复插入，因为有些业务下，重复插入数据是不被允许的</span></span><br><span class="line">                    userRepository.insertSysRoleMenuTable(roleId, menuId)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">def</span> parseMenuIdList(<span class="keyword">def</span> menuIdListString) &#123;</span><br><span class="line">        <span class="keyword">def</span> parseString = menuIdListString.substring(<span class="number">1</span>, menuIdListString.size() - <span class="number">1</span>) <span class="comment">//这里把用逗号隔开的menuIdList转换为一个数组存放所有的menuId</span></span><br><span class="line">        parseString.split(<span class="string">","</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> ifRoleIdMenuIdExist(roleId, menuId) &#123;</span><br><span class="line">        userRepository.getRoleMenuRel(roleId, menuId) ? true : <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> initGlobalUser() &#123;    <span class="comment">//这里是包的总的方法，也是这个Class对外的行为，是个public的方法，在需要初始化数据的地方调用该方法即可，其他方法都被包在这个Class中隐藏起来</span></span><br><span class="line">        initGlobalRole()</span><br><span class="line">        initRoleMenuId()</span><br><span class="line">        addGlobalUsers()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>  此部分使用到了UserRepository类，UserService类以及CrownFileService类</p>
</li>
<li><p>ConfigParse</p>
  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">package com.winicssec.crown.util</span><br><span class="line">/**</span><br><span class="line"> * 此部分用于的密码加密和读取文件</span><br><span class="line"> */</span><br><span class="line">class ConfigParse &#123;</span><br><span class="line">    CrownFileService crownFileService</span><br><span class="line"></span><br><span class="line">    ConfigParse()&#123;</span><br><span class="line">        crownFileService = new CrownFileService()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private def getConfigs(String configFilePath)&#123;</span><br><span class="line">        def configs = crownFileService.getConfigs(configFilePath) //传入yaml文件的路径，然后获取整个yaml文件的内容</span><br><span class="line">        def sysEnv = System.getenv(&quot;ACTIVE_ENV&quot;) //读取名称为“ACTIVE_ENV”的环境变量</span><br><span class="line">        def active = sysEnv ? sysEnv : configs.active //如果环境变量存在，则读取环境变量的值，如果环境变量不存在，则读取yaml文件中active值</span><br><span class="line">        configs.putAll(configs.get(active))</span><br><span class="line">        //通过active值获取对应环境的配置信息，例如如果active的值是“active“，那么自动化脚本在运行时就会获取active下面配置的db连接信息和ServerUrl</span><br><span class="line">        configs</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private def decryptConfig(Map&lt;String,Object&gt;configs,secretKey)&#123;</span><br><span class="line">        configs.each &#123;</span><br><span class="line">            it -&gt;</span><br><span class="line">                if(it.getValue() instanceof String)&#123;</span><br><span class="line">                    if(it.getValue().startsWith(&quot;[ENC&quot;))&#123;</span><br><span class="line">                        it.setValue Secret.decrypt(secretKey, it.getValue().replace(&quot;[ENC]&quot;,&quot;&quot;))</span><br><span class="line">                    &#125;</span><br><span class="line">                    //调用secret中的加解密方法</span><br><span class="line">                &#125; else if(it.getValue() instanceof Map)&#123;</span><br><span class="line">                    decryptConfig(it.getValue(),secretKey)</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        configs</span><br><span class="line">    &#125;</span><br><span class="line">    def getGlobalConfig()&#123;</span><br><span class="line">        def configs</span><br><span class="line">        configs = getConfigs(&quot;src/test/resources/crown/config/crownConfig.yml&quot;)</span><br><span class="line">        decryptConfig(configs,configs.decryptKey)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>  此部分使用到了secret的密码加解密类</p>
</li>
<li><p>UserRepository</p>
  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">package com.winicssec.crown.scenario.userManage.repository</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 此类用于操作数据库获取需要的数据</span><br><span class="line"> */</span><br><span class="line">class UserRepository extends com.winicssec.crown.util.CrownDataSource&#123;</span><br><span class="line">    def getUserInfoByUserName(loginName) &#123;</span><br><span class="line">        def getUserInfoByLoginNameSql = &quot;select * from sys_user where login_name=?&quot;</span><br><span class="line">        def userInfo = crownDB.firstRow(getUserInfoByLoginNameSql, [loginName])</span><br><span class="line">        userInfo ? userInfo : &quot;&quot;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    def insertSysUserTable(loginName, nickName, password, email, phone, status) &#123;  //插入用户</span><br><span class="line">        def insertUserSql = &quot;insert into sys_user(login_name,nickName,password,email,phone,status,create_uid,create_time,update_time) values (?,?,?,?,?,?,1,&apos;2019-07-01 10:00:00&apos;,&apos;2019-07-01 10:00:00&apos;)&quot;</span><br><span class="line">        crownDB.execute(insertUserSql, [loginName, nickName, password, email, phone, status])</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    def insertSysRoleTable(roleName) &#123;  //插入角色</span><br><span class="line">        def insertRoleSql = &quot;insert into sys_role(role_name,remark,create_time,update_time,create_uid,update_uid) values (?,&apos;addUserByApiTest&apos;,&apos;2019-07-01 10:00:00&apos;,&apos;2019-07-01 10:00:00&apos;,1,1)&quot;</span><br><span class="line">        crownDB.execute(insertRoleSql, [roleName])</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    void deleteUserTableByUserName(userName) &#123;  //根据用户名删除用户</span><br><span class="line">        def deleteSysUserRoleSql = &quot;delete from sys_user where login_name=?&quot;</span><br><span class="line">        crownDB.execute(deleteSysUserRoleSql, [userName])</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    void deleteUserRoleTableByUserName(userName) &#123;  //根据角色名删除角色</span><br><span class="line">        def deleteSysUserRoleSql = &quot;delete from sys_user_role where uid in (select uid from sys_user where login_name=?)&quot;</span><br><span class="line">        crownDB.execute(deleteSysUserRoleSql, [userName])</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    def insertSysUserRoleTable(uid, roleId) &#123;   //插入角色</span><br><span class="line">        def insertSysUserRoleSql = &quot;insert into sys_user_role(uid,role_id) values(?,?)&quot;</span><br><span class="line">        crownDB.execute(insertSysUserRoleSql, [uid, roleId])</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    def getRoleInfoByRoleName(roleName) &#123;  //根据角色名获取角色信息</span><br><span class="line">        def getRoleInfoSql = &quot;select * from sys_role where role_name=?&quot;</span><br><span class="line">        def roleInfo = crownDB.firstRow(getRoleInfoSql, [roleName])</span><br><span class="line">        roleInfo ? roleInfo : &quot;&quot;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    def getRoleMenuRel(roleId, menuId) &#123;</span><br><span class="line">        def roleIdMenuInfoSql = &quot;select * from sys_role_menu where role_id=? and menu_id=?&quot;</span><br><span class="line">        def roleMenuInfo = crownDB.firstRow(roleIdMenuInfoSql, [roleId, menuId])</span><br><span class="line">        roleMenuInfo ? roleMenuInfo : &quot;&quot;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    def insertSysRoleMenuTable(roleId, menuId) &#123;</span><br><span class="line">        def insertRoleMenuSql = &quot;insert sys_role_menu(role_id,menu_id) values (?,?)&quot;</span><br><span class="line">        crownDB.execute(insertRoleMenuSql, [roleId, menuId])</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    def searchUserCount(loginName, nickName, status) &#123;</span><br><span class="line">        def searchUserSql = &quot;select count(*) as numbers from sys_user where login_name like ? and nickname like ? and status like ?&quot;</span><br><span class="line">        crownDB.firstRow(searchUserSql, [loginName, nickName, status]).numbers</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    def getUserRole(loginName) &#123;</span><br><span class="line">        def getUserRoleSql=&quot;select * from sys_user_role where uid in (select uid from sys_user where login_name =?)&quot;</span><br><span class="line">        crownDB.firstRow(getUserRoleSql,[loginName])</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>UserService</p>
  <figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.winicssec.crown.scenario.userManage.service</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.winicssec.crown.scenario.userManage.repository.UserRepository</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.digest.Md5Crypt</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserService</span> &#123;</span></span><br><span class="line">    UserRepository userRepository</span><br><span class="line"></span><br><span class="line">    UserService()&#123;</span><br><span class="line">        userRepository = <span class="keyword">new</span> UserRepository()  <span class="comment">//用于查询数据</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">boolean</span> ifUserExist(<span class="keyword">def</span> loginName)&#123;   <span class="comment">//判断用户是否已经存在，大部分系统中不允许重复用户存在</span></span><br><span class="line">        userRepository.getUserInfoByUserName(loginName) ? true : <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> getEncryptPassword(password, loginName)&#123;  <span class="comment">//用户名密码加密</span></span><br><span class="line">        Md5Crypt.apr1Crypt(password, loginName)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> addUser(<span class="keyword">def</span> loginName, <span class="keyword">def</span> password = <span class="string">"abc123"</span>, <span class="keyword">def</span> roleName = <span class="string">"systemManager"</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!ifUserExist(loginName))&#123;</span><br><span class="line">            userRepository.insertSysUserTable(loginName,loginName,getEncryptPassword(password,loginName),<span class="string">"test@163.com"</span>, <span class="string">"18181971234"</span>, <span class="number">0</span>)</span><br><span class="line">            userRepository.insertSysUserRoleTable(userRepository.getUserInfoByUserName(loginName).uid, userRepository.getRoleInfoByRoleName(roleName).id)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> deleteUser(<span class="keyword">def</span> loginName)&#123;  <span class="comment">//删除用户</span></span><br><span class="line">        userRepository.deleteUserRoleTableByUserName(loginName)</span><br><span class="line">        userRepository.deleteUserTableByUserName(loginName)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> generateUniqueLoginName()&#123;   <span class="comment">//产生不重复用户名</span></span><br><span class="line">        <span class="keyword">boolean</span> ifContinue</span><br><span class="line">        <span class="keyword">def</span> loginName</span><br><span class="line">        ifContinue = <span class="literal">true</span></span><br><span class="line">        <span class="keyword">while</span>(ifContinue)&#123;</span><br><span class="line">            loginName = <span class="string">"name"</span> + <span class="keyword">new</span> Random().nextInt()</span><br><span class="line">            <span class="keyword">if</span>(!ifUserExist(loginName))&#123;</span><br><span class="line">                ifContinue = <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        loginName</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">def</span> generateUserRoleList(roleName)&#123;  <span class="comment">//生成角色列表</span></span><br><span class="line">        <span class="keyword">def</span> roleList = []</span><br><span class="line">        roleList[<span class="number">0</span>] = (userRepository.getRoleInfoByRoleName(roleName)).id</span><br><span class="line">        roleList</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> getUserNumbersForSearch(loginName = <span class="string">""</span>, nickName = <span class="string">""</span> , status = <span class="string">""</span>)&#123;</span><br><span class="line">        userRepository.searchUserCount(convertSearchKeyWord(loginName), convertSearchKeyWord(nickName), convertSearchKeyWord(status))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">def</span> convertSearchKeyWord(searchKeyWord)&#123;</span><br><span class="line">        searchKeyWord + <span class="string">'%'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>CrownDataSource和CrownFileService以及Secret</p>
  <figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.winicssec.crown.util</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 此类是Groovy连接数据库的固定写法</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> groovy.sql.Sql</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CrownDataSource</span> &#123;</span></span><br><span class="line">    Sql crownDB</span><br><span class="line">    ConfigParse configParse</span><br><span class="line">    <span class="keyword">def</span> configs</span><br><span class="line"></span><br><span class="line">    CrownDataSource()&#123;</span><br><span class="line">        configParse = <span class="keyword">new</span> ConfigParse()</span><br><span class="line">        configs = configParse.getGlobalConfig()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Sql getCrownDB()&#123;</span><br><span class="line">        <span class="keyword">if</span>(!crownDB)&#123;</span><br><span class="line">            <span class="keyword">def</span> mysqlDB = [</span><br><span class="line">                    <span class="string">driver  :</span> <span class="string">'com.mysql.jdbc.Driver'</span>,</span><br><span class="line">                    <span class="string">url     :</span> configs.local.db.url,</span><br><span class="line">                    <span class="string">user    :</span> configs.local.db.user,</span><br><span class="line"><span class="symbol">                    password:</span> configs.local.db.password</span><br><span class="line">            ]</span><br><span class="line">            crownDB = Sql.newInstance(mysqlDB.url, mysqlDB.user, mysqlDB.password, mysqlDB.driver)</span><br><span class="line">        &#125;</span><br><span class="line">        crownDB</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.winicssec.crown.util</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.xlson.groovycsv.CsvParser</span><br><span class="line"><span class="keyword">import</span> groovy.json.JsonSlurper</span><br><span class="line"><span class="keyword">import</span> org.yaml.snakeyaml.Yaml</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 此类用于导入各类的配置文件</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CrownFileService</span> &#123;</span></span><br><span class="line">    JsonSlurper jsonSlurper</span><br><span class="line">    XmlSlurper xmlSlurper</span><br><span class="line">    CsvParser csvParser</span><br><span class="line"></span><br><span class="line">    CrownFileService()&#123;</span><br><span class="line">        jsonSlurper = <span class="keyword">new</span> JsonSlurper()</span><br><span class="line">        xmlSlurper = <span class="keyword">new</span> XmlSlurper()</span><br><span class="line">        xmlSlurper.setFeature(<span class="string">"http://apache.org/xml/features/disallow-doctype-decl"</span>,<span class="literal">false</span>)</span><br><span class="line">        csvParser = <span class="keyword">new</span> CsvParser()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> createFile(path)&#123;</span><br><span class="line">        <span class="keyword">new</span> File(path)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">def</span> yml(String text)&#123;  <span class="comment">//yml类型文件的导入</span></span><br><span class="line">        <span class="keyword">new</span> Yaml().load(text)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> getConfigs(String ymlFilePath)&#123;</span><br><span class="line">        <span class="keyword">def</span> configs = yml(createFile(ymlFilePath).text)</span><br><span class="line">        configs</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> getCollectionFromXMLFile(String xmlFilePath) &#123;   <span class="comment">//XML文件的导入</span></span><br><span class="line">        xmlSlurper.parse(createFile(xmlFilePath))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">def</span> getCollectionFromJsonFile(String jsonFilePath) &#123;  <span class="comment">//Json类型文件的导入</span></span><br><span class="line">        jsonSlurper.parse(createFile(jsonFilePath))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">def</span> getCsvFileContent(String csvFilePath, separator) &#123;  <span class="comment">//CSV类型文件的导入</span></span><br><span class="line">        csvParser.parse(<span class="keyword">new</span> FileReader(createFile(csvFilePath)), <span class="string">separator:</span> separator)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.winicssec.crown.util</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.crypto.Cipher</span><br><span class="line"><span class="keyword">import</span> javax.crypto.SecretKey</span><br><span class="line"><span class="keyword">import</span> javax.crypto.SecretKeyFactory</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.PBEKeySpec</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.PBEParameterSpec</span><br><span class="line"><span class="keyword">import</span> java.security.spec.AlgorithmParameterSpec</span><br><span class="line"><span class="keyword">import</span> java.security.spec.KeySpec</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 加解密的一种方式，固定用法</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Secret</span> &#123;</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] salt = [ (<span class="keyword">byte</span>) <span class="number">0xA9</span>, (<span class="keyword">byte</span>) <span class="number">0x9B</span>, (<span class="keyword">byte</span>) <span class="number">0xC8</span>, (<span class="keyword">byte</span>) <span class="number">0x32</span>, (<span class="keyword">byte</span>) <span class="number">0x56</span>, (<span class="keyword">byte</span>) <span class="number">0x35</span>, (<span class="keyword">byte</span>) <span class="number">0xE3</span>, (<span class="keyword">byte</span>) <span class="number">0x03</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">//包的加密方法，调用的时候需要传入key和明文，方法返回加密后的密文</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> String encrypt(String secretKey, String plainText) <span class="keyword">throws</span> Exception      </span><br><span class="line">    &#123;    KeySpec keySpec = <span class="keyword">new</span> PBEKeySpec(secretKey.toCharArray(), salt, <span class="number">19</span>)</span><br><span class="line">        SecretKey key = SecretKeyFactory.getInstance(<span class="string">"PBEWithMD5AndDES"</span>).generateSecret(keySpec)</span><br><span class="line">        AlgorithmParameterSpec paramSpec = <span class="keyword">new</span> PBEParameterSpec(salt, <span class="number">19</span>)</span><br><span class="line">        Cipher cipher = Cipher.getInstance(key.getAlgorithm())</span><br><span class="line">        cipher.init(Cipher.ENCRYPT_MODE, key, paramSpec)</span><br><span class="line">        String charSet = <span class="string">"UTF-8"</span></span><br><span class="line">        <span class="keyword">byte</span>[] input = plainText.getBytes(charSet)</span><br><span class="line">        <span class="keyword">byte</span>[] output = cipher.doFinal(input)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> String(Base64.getEncoder().encode(output))&#125;</span><br><span class="line"></span><br><span class="line"> <span class="comment">//包的解密方法，调用的时候需要传入key和加密后的密文</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> String decrypt(String secretKey, String encryptedText) <span class="keyword">throws</span> Exception          </span><br><span class="line">    &#123;    KeySpec keySpec = <span class="keyword">new</span> PBEKeySpec(secretKey.toCharArray(), salt, <span class="number">19</span>)</span><br><span class="line">        SecretKey key = SecretKeyFactory.getInstance(<span class="string">"PBEWithMD5AndDES"</span>).generateSecret(keySpec)</span><br><span class="line">        AlgorithmParameterSpec paramSpec = <span class="keyword">new</span> PBEParameterSpec(salt, <span class="number">19</span>)</span><br><span class="line">        Cipher cipher = Cipher.getInstance(key.getAlgorithm())</span><br><span class="line">        cipher.init(Cipher.DECRYPT_MODE, key, paramSpec)</span><br><span class="line">        <span class="keyword">byte</span>[] enc = Base64.getDecoder().decode(encryptedText)</span><br><span class="line">        <span class="keyword">byte</span>[] utf8 = cipher.doFinal(enc)</span><br><span class="line">        String charSet = <span class="string">"UTF-8"</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> String(utf8, charSet)&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//写了个main方法来调用上面两个方法</span></span><br><span class="line">     <span class="keyword">static</span> <span class="keyword">void</span> main(String[] args) <span class="keyword">throws</span> Exception      </span><br><span class="line">    &#123;   String key = <span class="string">"apiTestStudy"</span>               <span class="comment">//设置key值，这里使用的是对称加密，加密和解密时使用相同的key值即可，key具体的值自己可以任意设置</span></span><br><span class="line">        String plain = <span class="string">"apiPassword"</span>              <span class="comment">//明文密码</span></span><br><span class="line">        String enc = encrypt(key, plain)          <span class="comment">//加密后的密码</span></span><br><span class="line">        System.out.println(<span class="string">"Original text: "</span> + plain)</span><br><span class="line">        System.out.println(<span class="string">"Encrypted text: "</span> + enc)</span><br><span class="line">        String encs=<span class="string">"/DgMfJk8Y7YvMrMBiD881A=="</span>    <span class="comment">//加密后的密文 </span></span><br><span class="line">        String plainAfter = decrypt(key, encs)    <span class="comment">//密文解密</span></span><br><span class="line">        System.out.println(<span class="string">"Original text after decryption: "</span> + plainAfter)   <span class="comment">//解密后的明文</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>UserClient</p>
  <figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.winicssec.crown.scenario.userManage.client</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.winicssec.crown.util.login.LoginClient</span><br><span class="line"><span class="keyword">import</span> groovy.json.JsonSlurper</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 此类用于调用各类测试接口</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserClient</span> &#123;</span></span><br><span class="line">    LoginClient loginClient</span><br><span class="line">    JsonSlurper jsonSlurper</span><br><span class="line"></span><br><span class="line">    UserClient() &#123;</span><br><span class="line">        loginClient = <span class="keyword">new</span> LoginClient()</span><br><span class="line">        jsonSlurper = <span class="keyword">new</span> JsonSlurper()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> addUser(<span class="keyword">def</span> addUserRoleName, <span class="keyword">def</span> body) &#123;</span><br><span class="line">        loginClient.clientWithSpecialRole(addUserRoleName)</span><br><span class="line">                .body(body)</span><br><span class="line">                .when()</span><br><span class="line">                .post(<span class="string">'/users'</span>)</span><br><span class="line">                .then().log().all()</span><br><span class="line">                .assertThat()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> editUser(<span class="keyword">def</span> editUserRoleName, <span class="keyword">def</span> uid, <span class="keyword">def</span> body) &#123;</span><br><span class="line">        loginClient.clientWithSpecialRole(editUserRoleName)</span><br><span class="line">                .body(body)</span><br><span class="line">                .pathParam(<span class="string">"userId"</span>, uid)</span><br><span class="line">                .when()</span><br><span class="line">                .put(<span class="string">"/users/&#123;userId&#125;"</span>)</span><br><span class="line">                .then().assertThat()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> searchUser(<span class="keyword">def</span> searchUserRoleName, loginName = <span class="string">""</span>, nickName = <span class="string">""</span>, status = <span class="string">""</span>) &#123;</span><br><span class="line">        <span class="keyword">def</span> response = loginClient.clientWithSpecialRole(searchUserRoleName)</span><br><span class="line">                .queryParam(<span class="string">"loginName"</span>, (String) loginName)</span><br><span class="line">                .queryParam(<span class="string">"nickname"</span>, (String) nickName)</span><br><span class="line">                .queryParam(<span class="string">"status"</span>, (String) status)</span><br><span class="line">                .when()</span><br><span class="line">                .get(<span class="string">"/users?cursor=1&amp;limit=10"</span>)</span><br><span class="line">                .then().assertThat().statusCode(<span class="number">200</span>)</span><br><span class="line">                .extract().response().getBody().asString()</span><br><span class="line">        jsonSlurper.parseText(response)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> searchUserWithLimit(<span class="keyword">def</span> searchUserRoleName, <span class="keyword">def</span> limit) &#123;</span><br><span class="line">        <span class="keyword">def</span> response = loginClient.clientWithSpecialRole(searchUserRoleName)</span><br><span class="line">                .queryParam(<span class="string">"limit"</span>, (String) limit)</span><br><span class="line">                .when()</span><br><span class="line">                .get(<span class="string">"/users?cursor=1"</span>)</span><br><span class="line">                .then().assertThat().statusCode(<span class="number">200</span>)</span><br><span class="line">                .extract().response().getBody().asString()</span><br><span class="line">        jsonSlurper.parseText(response)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> resetUserPassword(<span class="keyword">def</span> resetPasswordRoleName, <span class="keyword">def</span> uid) &#123;</span><br><span class="line">        loginClient.clientWithSpecialRole(resetPasswordRoleName)</span><br><span class="line">                .pathParam(<span class="string">"uid"</span>, uid)</span><br><span class="line">                .when()</span><br><span class="line">                .put(<span class="string">"users/&#123;uid&#125;/password"</span>)</span><br><span class="line">                .then().assertThat().statusCode(<span class="number">200</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> updateUserStatus(<span class="keyword">def</span> updateUserStatusRoleName, <span class="keyword">def</span> uid, <span class="keyword">def</span> statusCode) &#123;</span><br><span class="line">        <span class="keyword">def</span> body = [:]</span><br><span class="line">        body.put(<span class="string">"status"</span>, statusCode == <span class="number">0</span> ? 1 : <span class="number">0</span>)</span><br><span class="line">        loginClient.clientWithSpecialRole(updateUserStatusRoleName)</span><br><span class="line">                .pathParam(<span class="string">"uid"</span>, uid)</span><br><span class="line">                .body(body)</span><br><span class="line">                .when()</span><br><span class="line">                .put(<span class="string">"users/&#123;uid&#125;/status"</span>)</span><br><span class="line">                .then().assertThat().statusCode(<span class="number">200</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="测试用例"><a href="#测试用例" class="headerlink" title="测试用例"></a>测试用例</h4><ul>
<li><p>AddUserTest</p>
  <figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Category</span>(CrownTest)     <span class="comment">//这里设置此Class属于CrownTest Category，作用是拆分testSuite</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AddUserTest</span> <span class="keyword">extends</span> <span class="title">Specification</span> &#123;</span></span><br><span class="line">    UserClient userClient</span><br><span class="line">    UserService userService</span><br><span class="line">    UserRepository userRepository</span><br><span class="line">    <span class="keyword">def</span> loginName = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> setup() &#123;                      <span class="comment">//每个case执行前都会先执行setup中的内容</span></span><br><span class="line">        userClient = <span class="keyword">new</span> UserClient()</span><br><span class="line">        userService = <span class="keyword">new</span> UserService()</span><br><span class="line">        userRepository = <span class="keyword">new</span> UserRepository()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> cleanup() &#123;                   <span class="comment">//每个case执行后都会执行cleanup中的内容，这里每次case执行完成后，删除添加的user，达到清理测试数据的目标</span></span><br><span class="line">        userService.deleteUser(loginName)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="string">"should add user successfully when filling all required information"</span>() &#123;</span><br><span class="line">        <span class="keyword">def</span> roleIdList = userService.generateUserRoleList(addedUserRoleName)    </span><br><span class="line">        <span class="comment">// 上面的代码是根据被添加的用户角色生成对应的角色ID List，页面上创建一个user，选中对应角色时看到的是角色名称，而实际插入数据库的数据是角色对应的Id值，所以这里包了一个方法根据角色名称得到对应的roleIdList</span></span><br><span class="line"></span><br><span class="line"><span class="symbol">        given:</span> <span class="string">"generate add user api request body"</span></span><br><span class="line">        loginName = userService.generateUniqueLoginName()     </span><br><span class="line">        <span class="comment">//这里包了一个方法生成不重复的登陆名称，因为web应用限制了添加用户时，不能添加已经存在的登陆名称，所以为了保证case多次执行都能成功，我们需要包一个方法来生成不重复的登陆名称</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> body = <span class="keyword">new</span> UserBody()</span><br><span class="line">                .setUserLoginName(loginName)</span><br><span class="line">                .setUserNickName(<span class="string">"abc123NickName"</span>)</span><br><span class="line">                .setUerPhone(<span class="string">"18181971234"</span>)</span><br><span class="line">                .setUserEmail(<span class="string">"test@163.com"</span>)</span><br><span class="line">                .setRoleIdList(roleIdList)</span><br><span class="line">                .getAddUserBody()                <span class="comment">//这里采用build模式构造接口的reqeust body</span></span><br><span class="line"><span class="symbol">        when:</span> <span class="string">"call add user api interface"</span></span><br><span class="line">        userClient.addUser(addUserRoleName, body)    <span class="comment">//这里addUser()方法实现调用添加user的接口</span></span><br><span class="line">                .statusCode(<span class="number">201</span>)</span><br><span class="line"><span class="symbol">        then:</span> <span class="string">"should add user in db successfully"</span></span><br><span class="line">        Assert.assertTrue(userService.ifUserExist(loginName))   <span class="comment">//接口调用后判断被添加的用户确实被添加了</span></span><br><span class="line"><span class="symbol">        where:</span></span><br><span class="line">        addUserRoleName | addedUserRoleName      <span class="comment">//这里通过data-driven的方式覆盖了系统中三个角色都能添加user的测试场景</span></span><br><span class="line">        <span class="string">"systemManager"</span> | <span class="string">"roleManager"</span></span><br><span class="line">        <span class="string">"userManager"</span>   | <span class="string">"roleManager"</span></span><br><span class="line">        <span class="string">"roleManager"</span>   | <span class="string">"roleManager"</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="string">"should add user failed when not filling all required information"</span>() &#123;</span><br><span class="line">        <span class="keyword">def</span> roleIdList = userService.generateUserRoleList(addedUserRoleName)   <span class="comment">//同上，这里是通过传入被添加的角色名称生成对应的roleList</span></span><br><span class="line"><span class="symbol">        given:</span> <span class="string">"generate add user api request body"</span></span><br><span class="line">        loginName = userService.generateUniqueLoginName()        <span class="comment">//添加一个唯一的登陆名称</span></span><br><span class="line">        <span class="keyword">def</span> body = <span class="keyword">new</span> UserBody()</span><br><span class="line">                .setUserLoginName(loginName)</span><br><span class="line">                .setUserNickName(nickName)</span><br><span class="line">                .setUerPhone(phone)</span><br><span class="line">                .setUserEmail(email)</span><br><span class="line">                .setRoleIdList(roleIdList)</span><br><span class="line">                .getAddUserBody()               <span class="comment">//构建添加user的requst body</span></span><br><span class="line"><span class="symbol">        when:</span> <span class="string">"call add user api interface"</span></span><br><span class="line">        userClient.addUser(addUserRoleName, body)</span><br><span class="line">                .statusCode(<span class="number">400</span>)</span><br><span class="line"><span class="symbol">        then:</span> <span class="string">"should add user in db successfully"</span></span><br><span class="line">        Assert.assertFalse(userService.ifUserExist(loginName))     <span class="comment">//这里因为都是异常测试场景，所以校验被添加的用户没有成功被添加</span></span><br><span class="line"><span class="symbol">        where:</span></span><br><span class="line">        nickName   | phone         | email          | addedUserRoleName | addUserRoleName</span><br><span class="line">        <span class="string">""</span>         | <span class="string">"18181971234"</span> | <span class="string">"test@163.com"</span> | <span class="string">"roleManager"</span>  | <span class="string">"systemManager"</span></span><br><span class="line">        <span class="string">"nickName"</span> | <span class="string">""</span>            | <span class="string">"test@163.com"</span> | <span class="string">"roleManager"</span>  | <span class="string">"systemManager"</span></span><br><span class="line">        <span class="string">"nickName"</span> | <span class="string">"18181971234"</span> | <span class="string">""</span>             | <span class="string">"roleManager"</span>  | <span class="string">"systemManager"</span></span><br><span class="line">        <span class="string">"nickName"</span> | <span class="string">"18181971234"</span> | <span class="string">"test@163.com"</span> | <span class="string">""</span>         | <span class="string">"systemManager"</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 添加用户异常测试场景中，当email为空时，系统没有报错，仍然允许添加用户，属于系统issue，所以添加用户的异常场景会有一个失败</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>EditUserTest</p>
  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">@Category([CrownTest])</span><br><span class="line">class EditUserTest extends Specification &#123;</span><br><span class="line">    UserService userService</span><br><span class="line">    UserRepository userRepository</span><br><span class="line">    UserClient userClient</span><br><span class="line">    def loginName=&quot;userForEdit&quot;</span><br><span class="line"></span><br><span class="line">    def setup() &#123;</span><br><span class="line">        userService = new UserService()</span><br><span class="line">        userRepository = new UserRepository()</span><br><span class="line">        userClient = new UserClient()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    def cleanup() &#123;</span><br><span class="line">        userService.deleteUser(loginName)     //每一次case执行完成后都会清理掉名称为“userForEdit”的用户，where里面有三行测试数据，等同于三个case</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    def &quot;should update user details successfully&quot;() &#123;</span><br><span class="line">        given: &quot;create a exist user&quot;</span><br><span class="line">        userService.addUser(loginName,&quot;abc123&quot;,&quot;systemManager&quot;)     </span><br><span class="line">    //为了测试编辑用户场景，需要提前创建一个存在的用户，这里userService中包了一个addUser的方法，这里是通过直接操作数据库的方式添加user，传入登陆名称，密码，角色名称即可添加一个user</span><br><span class="line"></span><br><span class="line">        def userInfo=userRepository.getUserInfoByUserName(loginName)           //获取已经创建的用户信息</span><br><span class="line">        and: &quot;generate edit user body&quot;</span><br><span class="line">        def reqBody = new UserBody()</span><br><span class="line">                .setUserIdForEditUser(userInfo.uid)      //编辑用户的接口里面需要传递被修改用户的uid</span><br><span class="line">                .setUserLoginName(loginName)</span><br><span class="line">                .setUserNickName(newNickName)</span><br><span class="line">                .setUerPhone(newPhone)</span><br><span class="line">                .setUserEmail(newEmail)</span><br><span class="line">                .setRoleIdList(userService.generateUserRoleList(&quot;roleManager&quot;))   //编辑用户的request body中设置把用户都修改为“roleManage”角色</span><br><span class="line">                .getAddUserBody()</span><br><span class="line">        when: &quot;edit user details&quot;</span><br><span class="line">        userClient.editUser(updateUserRoleName,userInfo.uid,reqBody)</span><br><span class="line">                  .statusCode(200)                     //调用编辑用户接口，编辑用户信息</span><br><span class="line">        then: &quot;should edit successfully&quot;</span><br><span class="line">        def newUserInfo=userRepository.getUserInfoByUserName(loginName)</span><br><span class="line">        assertThat(newUserInfo.nickName).isEqualTo(newNickName)</span><br><span class="line">        assertThat(newUserInfo.phone).isEqualTo(newPhone)</span><br><span class="line">        assertThat(newUserInfo.email).isEqualTo(newEmail)      //校验用户新的信息与期望被修改的信息一致</span><br><span class="line">        assertThat(userRepository.getUserRole(loginName).role_id).isEqualTo(userRepository.getRoleInfoByRoleName(&quot;roleManager&quot;).id)</span><br><span class="line">        // 校验被修改的用户角色确实是roleManager</span><br><span class="line">        where:</span><br><span class="line">        updateUserRoleName|newNickName|newPhone|newEmail</span><br><span class="line">        &quot;systemManager&quot;| &quot;newNickName&quot;|&quot;18181991122&quot;|&quot;newEmail@163.com&quot;</span><br><span class="line">        &quot;userManager&quot;| &quot;newNickName&quot;|&quot;18181991122&quot;|&quot;newEmail@163.com&quot;</span><br><span class="line">        &quot;roleManager&quot;| &quot;newNickName&quot;|&quot;18181991122&quot;|&quot;newEmail@163.com&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>UpdateUserStatusTest</p>
  <figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Category</span>([CrownTest])</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UpdateUserStatusTest</span> <span class="keyword">extends</span> <span class="title">Specification</span> &#123;</span></span><br><span class="line">    UserClient userClient</span><br><span class="line">    UserService userService</span><br><span class="line">    UserRepository userRepository</span><br><span class="line">    <span class="keyword">def</span> testUserLoginName = <span class="string">"statusTest"</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> setup() &#123;</span><br><span class="line">        userClient = <span class="keyword">new</span> UserClient()</span><br><span class="line">        userService = <span class="keyword">new</span> UserService()</span><br><span class="line">        userRepository = <span class="keyword">new</span> UserRepository()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> clean() &#123;</span><br><span class="line">        userService.deleteUser(testUserLoginName)    <span class="comment">//case运行完成后会删除被测用户</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="string">"should update user status successfully"</span>() &#123;</span><br><span class="line"><span class="symbol">        given:</span> <span class="string">"add a test user"</span></span><br><span class="line">        userService.addUser(testUserLoginName)   <span class="comment">//添加一个用户，用于后面修改状态测试</span></span><br><span class="line"><span class="symbol">        when:</span> <span class="string">"update user status"</span></span><br><span class="line">        <span class="keyword">def</span> userInfo = userRepository.getUserInfoByUserName(testUserLoginName)    <span class="comment">//获取被测用户信息</span></span><br><span class="line">        userClient.updateUserStatus(updateStatusUserRoleName, userInfo.uid, userInfo.status)    <span class="comment">//调用修改状态接口，修改用户状态</span></span><br><span class="line"><span class="symbol">        then:</span> <span class="string">"should update user status successfully"</span></span><br><span class="line">        assertThat(userInfo.status).isNotEqualTo(userRepository.getUserInfoByUserName(testUserLoginName).status)   <span class="comment">//校验修改状态后的状态与修改前的状态不一致</span></span><br><span class="line"><span class="symbol">        where:</span></span><br><span class="line">        updateStatusUserRoleName | placeHolder</span><br><span class="line">        <span class="string">"systemManager"</span>          | <span class="string">""</span></span><br><span class="line">        <span class="string">"roleManager"</span>            | <span class="string">""</span></span><br><span class="line">        <span class="string">"userManager"</span>            | <span class="string">""</span>        <span class="comment">//测试三种角色都能修改用户状态</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ResetPasswordTest</p>
  <figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Category</span>([CrownTest])</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ResetPasswordTest</span> <span class="keyword">extends</span> <span class="title">Specification</span> &#123;</span></span><br><span class="line">    UserService userService</span><br><span class="line">    UserClient userClient</span><br><span class="line">    UserRepository userRepository</span><br><span class="line">    <span class="keyword">def</span> loginName = <span class="string">"userForReset"</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> setup() &#123;</span><br><span class="line">        userService = <span class="keyword">new</span> UserService()</span><br><span class="line">        userClient = <span class="keyword">new</span> UserClient()</span><br><span class="line">        userRepository = <span class="keyword">new</span> UserRepository()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> cleanup() &#123;</span><br><span class="line">        userService.deleteUser(loginName)       <span class="comment">//case运行完成后会删除被测用户</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="string">"should reset user password successfully"</span>() &#123;</span><br><span class="line"><span class="symbol">        given:</span> <span class="string">"create a user with password"</span></span><br><span class="line">        userService.addUser(loginName, password)   <span class="comment">//添加一个被测用户，用户密码都是abc456 </span></span><br><span class="line"><span class="symbol">        when:</span> <span class="string">"reset user password"</span></span><br><span class="line">        <span class="keyword">def</span> uid = userRepository.getUserInfoByUserName(loginName).uid     <span class="comment">//获取用户的uid，用户重置密码时需要</span></span><br><span class="line">        userClient.resetUserPassword(resetPasswordRoleName, uid)          <span class="comment">//调用接口重置用户密码</span></span><br><span class="line"><span class="symbol">        then:</span> <span class="string">"should user's password is equal to loginName"</span></span><br><span class="line">        assertThat(userRepository.getUserInfoByUserName(loginName).password).isEqualTo(userService.getEncryptPassword(loginName, loginName))</span><br><span class="line">       <span class="comment">//被测web应用如果重置密码，会把密码设置为登陆名称，因为数据库存储密码时做了加密处理，这里判断数据库存储的密码和用登录名加密后的内容一致</span></span><br><span class="line">       <span class="comment">//userService.getEncryptPassword使用的加密方式是从被测web应用中copy的</span></span><br><span class="line"><span class="symbol">        where:</span></span><br><span class="line">        password | resetPasswordRoleName     <span class="comment">//测试系统中的三种角色都可以重置用户密码</span></span><br><span class="line">        <span class="string">"abc456"</span> | <span class="string">"systemManager"</span></span><br><span class="line">        <span class="string">"abc456"</span> | <span class="string">"userManager"</span></span><br><span class="line">        <span class="string">"abc456"</span> | <span class="string">"roleManager"</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//修改用户密码场景没有写自动化，大家学习后可以自己尝试编写</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>SearchUserTest  检索用户场景</p>
  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">@Category([CrownTest])</span><br><span class="line">class SearchUserTest extends Specification &#123;</span><br><span class="line">    UserClient userClient</span><br><span class="line">    UserService userService</span><br><span class="line"></span><br><span class="line">    def setup() &#123;</span><br><span class="line">        userClient = new UserClient()</span><br><span class="line">        userService = new UserService()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    def &quot;should search user successfully&quot;() &#123;</span><br><span class="line">        given: &quot;no given&quot;</span><br><span class="line">        when: &quot;search user&quot;</span><br><span class="line">        def response = userClient.searchUser(searchUserRoleName, loginName, nickName, status)  </span><br><span class="line">        //调用检索接口</span><br><span class="line">        then: &quot;should get all valid user&quot;</span><br><span class="line">        assertThat(response.result.total).isEqualTo(userService.getUserNumbersForSearch(loginName, nickName, status))</span><br><span class="line">        //调用检索接口返回的response中的total个数与数据库中查询的数量一致则说明检索接口正确</span><br><span class="line">        where:</span><br><span class="line">        searchUserRoleName | loginName | nickName | status</span><br><span class="line">        &quot;systemManager&quot;    | &quot;name&quot;    | &quot;&quot;       | &quot;&quot;</span><br><span class="line">        &quot;systemManager&quot;    | &quot;&quot;        | &quot;abc&quot;    | &quot;&quot;</span><br><span class="line">        &quot;systemManager&quot;    | &quot;&quot;        | &quot;&quot;       | 0</span><br><span class="line">        &quot;roleManager&quot;    | &quot;&quot;        | &quot;&quot;       | 1       //这里使用了roleManger与userManager进行检索，主要是顺便覆盖三种角色都有检索用户接口权限</span><br><span class="line">        &quot;userManager&quot;    | &quot;crown&quot;   | &quot;crown&quot;  | 0</span><br><span class="line">        &quot;systemManager&quot;    | &quot;&quot;        | &quot;&quot;       | &quot;&quot;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    def &quot;should search user with limit successfully&quot;() &#123;</span><br><span class="line">        given: &quot;no given&quot;</span><br><span class="line">        when: &quot;search user with limit 20&quot;</span><br><span class="line">        def response = userClient.searchUserWithLimit(searchUserRoleName,limit)   //检索接口的时候设置检索的总量是20</span><br><span class="line">        then: &quot;should get valid user&quot;</span><br><span class="line">        assertThat(response.result.size).isEqualTo(limit)   //校验返回的response中用户数量是20</span><br><span class="line">        where:</span><br><span class="line">        searchUserRoleName|limit</span><br><span class="line">        &quot;systemManager&quot;|20</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>  ​</p>
</li>
</ul>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">WenJingliu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://yoursite.com/2020/01/07/如何搭建一个自动化接口测试框架/">http://yoursite.com/2020/01/07/如何搭建一个自动化接口测试框架/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://yoursite.com">LetonLIU的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://lemonliu.oss-cn-beijing.aliyuncs.com/a6b393ec5be60b6d07f20395034c77b.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button"><i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lozad post-qr-code__img" src="/img/wechat.jpg"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lozad post-qr-code__img" src="/img/alipay.jpg"><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull-left"><a href="/2020/01/07/如何有效学习数据结构与算法/"><img class="prev_cover lozad" data-src="https://lemonliu.oss-cn-beijing.aliyuncs.com/f75656b84fd8963b4d79af897750e4a.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>如何有效学习数据结构与算法</span></div></a></div><div class="next-post pull-right"><a href="/2020/01/06/IDEA快捷键/"><img class="next_cover lozad" data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span></span></div></a></div></nav><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div id="lv-container" data-id="city" data-uid="MTAyMC80NzIwNC8yMzcwNA=="><script>(function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
})(document, 'script');</script></div></div></div></div><footer><div id="footer"><div class="copyright">&copy;2018 - 2020 By WenJingliu</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换">繁</a><i class="nightshift fa fa-moon-o" id="nightshift" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script>$(function () {
  $('span.katex-display').wrap('<div class="katex-wrap"></div>')
})</script><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="/js/third-party/fireworks.js"></script><script src="/js/nightshift.js"></script><script id="ribbon" src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/js/piao.js"></script><script color="0,0,255" opacity="0.7" zindex="-1" count="99" src="https://cdn.jsdelivr.net/gh/jerryc127/CDN/js/canvas-nest.js"></script><script src="/js/tw_cn.js"></script><script>translateInitilization()

</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@1.2.2/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script><script>const observer = lozad(); // lazy loads elements with default selector as '.lozad'
observer.observe();
</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true,"breaks":true,"smartLists":true,"smartypants":true},"log":false});</script></body></html>